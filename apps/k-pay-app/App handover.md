---
# KP Pay App – Professional Handover & Developer Onboarding

## 1. Executive Summary

**KP Pay** is a modern, cross-platform mobile application for digital wallet management, payments, and merchant services. Built with React Native (Expo) and TypeScript, it is engineered for scalability, security, and internationalization. This document provides a comprehensive, professional handover and onboarding guide for developers, product managers, and stakeholders.

---

## 2. Product Vision & Core Features

**Vision:** Empower users and businesses to send/receive payments globally, manage multi-currency wallets, pay bills, and access merchant tools—all in a secure, intuitive mobile experience.

**Core Features:**

- Multi-currency wallets with real-time balances
- Currency conversion with live rates and transparent fees
- Payments, bill pay, and airtime purchase
- Secure authentication (JWT, 2FA)
- KYC onboarding and verification
- Merchant dashboard integration
- Internationalization (i18n) and accessibility
- Modern, responsive UI/UX

---

## 3. Technology Stack

| Component        | Technology              |
| ---------------- | ----------------------- |
| Framework        | React Native (Expo)     |
| Language         | TypeScript              |
| State Management | Zustand, React Context  |
| Forms/Validation | React Hook Form, Zod    |
| Styling          | TailwindCSS, NativeWind |
| API Client       | Axios                   |
| Testing          | Jest                    |
| CI/CD            | EAS, GitHub Actions     |
| Cloud/Infra      | AWS S3, CloudFront      |

---

## 4. Project Structure & Codebase Overview

### Top-Level Folders

- **app/**: All application screens, navigation, and feature flows. Subfolders group features (e.g., `airtime/`, `auth/`, `bills-and-payment/`, `card/`, `convert-currency/`, `deposit/`, `onboarding/`, `send-money/`, `ticket/`, `transactions/`, `two-factor-auth/`, `verification/`).
- **assets/**: Images, icons, and static assets for the app.
- **coverage/**: Test coverage reports (generated by Jest).
- **ios/**: Native iOS project files for building and deploying to the App Store.
- **k-pay-assets/**: Local package for shared design system, icons, and UI primitives.
- **schema/**: Zod schemas for validation (auth, banks, bill-payment, dashboard, personal-info, ticket, verifications).
- **src/**: Main source code (see below for details).

### `src/` Directory Breakdown

- **components/**: Reusable UI components (dropdowns, actions, currency selectors, alerts, wallet views, etc.).
- **constants/**: Static constants (country lists, bank providers, etc.).
- **contexts/**: React context providers for global state (e.g., authentication, currency).
- **data/**: Static/mock data for development and demos.
- **enums/**: TypeScript enums for app-wide constants.
- **helpers/**: Utility/helper functions (e.g., error handling).
- **hooks/**: Custom React hooks for business logic (auth, currencies, file upload, KYC, etc.).
- **icons/**: SVG and icon components.
- **layout/**: Layout wrappers for screens and authentication.
- **lib/**: Core libraries and integrations (API clients, GraphQL, socket, utils).
- **modules/**: Feature modules (beneficiaries, bill-payment, dashboard, exchange, merchants, payment-link, profile, search-bar, settings, sidebar, ticket, transactions, transfer, wallet).
- **providers/**: React context providers.
- **screens/**: Application screens (may be legacy or feature-specific).
- **services/**: Service layer for API integrations (bank, flutterwave, paystack).
- **store/**: Global state management (Zustand stores for user, wallet, KYC, etc.).
- **theme/**: Theme and style configuration.
- **translations/**: i18n translation files (English, French, Spanish, Arabic, etc.).
- **types/**: TypeScript type definitions and interfaces.
- **utils/**: General utility functions and helpers.
- **validations/**: Validation logic and schemas.

### Other Key Files

- **App.tsx**: Main app composition, providers, and layout.
- **app.json**: Expo/React Native app configuration.
- **global.css**: Global styles (Tailwind, NativeWind).
- **metro.config.js**: Metro bundler configuration.
- **tailwind.config.js**: TailwindCSS configuration.
- **tsconfig.json**: TypeScript configuration.

---

## 5. Folder-by-Folder Explanation

### app/

Contains all user-facing screens and navigation. Each subfolder is a feature or flow:

- **airtime/**: Airtime purchase UI and logic
- **auth/**: Authentication (login, reset, verify)
- **bills-and-payment/**: Bill payment flows
- **card/**: Card management (create, view, learn more)
- **convert-currency/**: Currency conversion
- **deposit/**: Deposit flows (bank, mobile money, etc.)
- **onboarding/**: User onboarding and registration
- **send-money/**: Send money feature
- **ticket/**: Support ticketing
- **transactions/**: Transaction history
- **two-factor-auth/**: 2FA flows
- **verification/**: KYC and verification

### assets/

All static images, icons, and branding assets used in the app.

### coverage/

Test coverage reports generated by Jest.

### ios/

Native iOS project files for App Store deployment and device builds.

### k-pay-assets/

Local package for shared design system, icons, and UI primitives. Built separately and imported as a dependency.

### schema/

Zod schemas for validation (auth, banks, bill-payment, dashboard, personal-info, ticket, verifications). Used for form validation and API data validation.

### src/

Main source code. Key subfolders:

- **components/**: Reusable UI components (dropdowns, actions, currency selectors, alerts, wallet views, etc.)
- **constants/**: Static constants (country lists, bank providers, etc.)
- **contexts/**: React context providers for global state (e.g., authentication, currency)
- **data/**: Static/mock data for development and demos
- **enums/**: TypeScript enums for app-wide constants
- **helpers/**: Utility/helper functions (e.g., error handling)
- **hooks/**: Custom React hooks for business logic (auth, currencies, file upload, KYC, etc.)
- **icons/**: SVG and icon components
- **layout/**: Layout wrappers for screens and authentication
- **lib/**: Core libraries and integrations (API clients, GraphQL, socket, utils)
- **modules/**: Feature modules (beneficiaries, bill-payment, dashboard, exchange, merchants, payment-link, profile, search-bar, settings, sidebar, ticket, transactions, transfer, wallet)
- **providers/**: React context providers
- **screens/**: Application screens (may be legacy or feature-specific)
- **services/**: Service layer for API integrations (bank, flutterwave, paystack)
- **store/**: Global state management (Zustand stores for user, wallet, KYC, etc.)
- **theme/**: Theme and style configuration
- **translations/**: i18n translation files (English, French, Spanish, Arabic, etc.)
- **types/**: TypeScript type definitions and interfaces
- **utils/**: General utility functions and helpers
- **validations/**: Validation logic and schemas

---

## 6. Key Implementation Details

### Authentication & Authorization

- Managed via the `useAuth` hook (`src/hooks/useAuth.ts`)
- JWT tokens stored securely; user state managed in Zustand store
- Token refresh and logout logic included

### Wallet Management

- Zustand store for wallet state (`src/store/wallet-store.ts`)
- Wallet persisted in local storage; methods for set, update, clear

### Payments & Transfers

- Modular forms with Zod validation
- API integration for all payment actions
- Step-based flows for transfers, withdrawals, and bill pay

### Currency Conversion

- Real-time rates and conversion logic in `app/convert-currency/`
- Fee breakdown and transparent calculations

### KYC & Verification

- Step-based onboarding and verification flows
- Document upload using custom hooks (e.g., `useFileUploadEnhanced`)
- Status tracking and error handling

### Internationalization (i18n)

- All user-facing text externalized to translation files in `src/translations/`
- Supports English, French, Spanish, Arabic, and more

### Testing & Quality Assurance

- Jest for unit/integration tests
- Coverage reports in `coverage/`

### Error Handling & Logging

- Centralized error boundaries and logging
- User feedback for all error states

### Performance & Best Practices

- Code splitting, lazy loading, and bundle optimization
- Feature branches and pull requests for all development
- Comprehensive documentation and code comments

---

## 7. Onboarding Steps for Developers

1. **Clone the repository** and install dependencies with `pnpm install`.
2. **Set up environment variables** in a `.env` file (see handover doc for keys).
3. **Run the app** locally with `pnpm start` (Expo Go or simulator).
4. **Review the folder structure** above to understand where features and logic reside.
5. **See this handover document** for deep dives into key features, troubleshooting, and best practices.

---

## 8. Additional Resources

- **API documentation**: Contact technical lead for access
- **Infrastructure/DevOps**: See `infrastructure/README.md` if present
- **Design system**: See `k-pay-assets/` for shared UI primitives
- **Support**: Contact project manager or technical lead for further onboarding

---

This handover is designed to ensure a smooth transition and rapid onboarding for new developers. For any questions or deeper technical dives, refer to the codebase, this document, or reach out to the technical lead.

- **Currency Converter**: (See Section 7 for details) Enables instant, transparent conversion between supported currencies, with live rates and fee breakdowns.
- **Payments & Transfers**: Send and receive money, pay bills, and buy airtime. All transactions are secure, logged, and user-friendly.
- **Merchant Tools**: (Web dashboard) Accept payments, manage customers, and access business analytics.
- **User Authentication & Security**: Secure registration, login, and two-factor authentication. Tokens and sensitive data are encrypted and stored securely.
- **Internationalization (i18n)**: Supports multiple languages. All user-facing text is translatable and easily updatable.
- **Modern UI/UX**: Clean, accessible, and responsive design, optimized for all devices.

# Official Project Handover Document

**Document Version:** 1.2

**Handover Date:** December 31, 2025

**Prepared By:** Emmanuel Obiabo

**Prepared For:** Stakeholders, Project Owners, Project Managers, Development Teams, QA Teams, and Support Personnel

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Project Overview](#2-project-overview)
   1. [Purpose](#21-purpose)
   2. [Key Features](#22-key-features)
   3. [Technology Stack](#23-technology-stack)
   4. [Current Status](#24-current-status)
3. [Target Audience](#3-target-audience)
4. [End User Guide (For Support Teams)](#4-end-user-guide-for-support-teams)
   1. [Access Points](#41-access-points)
   2. [Main User Flows](#42-main-user-flows)
   3. [Support Guidelines](#43-support-guidelines)
5. [Developer Guide](#5-developer-guide)
   1. [Prerequisites](#51-prerequisites)
   2. [Local Setup Instructions](#52-local-setup-instructions)
   3. [Environment Variables](#53-environment-variables)
   4. [Project Structure](#54-project-structure)
6. [Architecture Highlights](#6-architecture-highlights)
7. [Deployment](#7-deployment)
   1. [Environments](#71-environments)
   2. [CI/CD Pipeline](#72-cicd-pipeline)
   3. [Manual Deployment](#73-manual-deployment)
   4. [Infrastructure](#74-infrastructure)
8. [Troubleshooting and Maintenance](#8-troubleshooting-and-maintenance)
   1. [Common Fixes](#81-common-fixes)
   2. [Best Practices](#82-best-practices)
9. [Risk Assessment and Recommendations](#9-risk-assessment-and-recommendations)
10. [Tools and Resources](#10-tools-and-resources)
11. [Additional Documentation](#11-additional-documentation)
12. [Contacts and Support](#12-contacts-and-support)
13. [Technical Deep Dive: Key Feature Implementation](#13-technical-deep-dive-key-feature-implementation)
14. [Complete Package Reference](#14-complete-package-reference)
15. [Source Directory Structure](#15-source-directory-structure)
16. [Root Folder Structure](#16-root-folder-structure)
17. [Additional Core Feature Details](#17-additional-core-feature-details)

---

## 1. Executive Summary

This document serves as the official handover documentation for the KPay User Frontend application. It provides comprehensive technical specifications, architectural guidelines, deployment procedures, and maintenance protocols to ensure seamless operational continuity and knowledge transfer.

The KPay User Frontend is an enterprise-grade, security-hardened, multilingual web application that enables end users to manage digital wallets, execute payment transactions, and complete regulatory-compliant KYC verification processes. The application architecture prioritizes scalability, performance optimization, and long-term maintainability.

### Primary Handover Objectives

- Facilitate efficient onboarding for incoming development personnel and team members
- Provide stakeholders with a comprehensive understanding of system capabilities and operational status
- Establish clear protocols for maintenance procedures, system updates, and troubleshooting workflows
- Ensure operational continuity throughout team transitions and organizational changes

---

## 2. Project Overview

### 2.1 Purpose

KPay is an enterprise digital payment platform designed to facilitate secure financial transactions across multiple channels. The User Frontend application serves as the primary interface enabling end users to:

- Manage digital wallet operations (fund loading, balance inquiries, inter-wallet transfers)
- Execute payment transactions to merchants, utility providers, and peer users
- Complete regulatory-mandated KYC identity verification workflows for compliance adherence
- Utilize the platform across multiple languages for international accessibility

### 2.2 Key Features

- Secure user authentication and authorization utilizing JWT token-based authentication protocols
- Comprehensive wallet management interface with transaction history and analytics
- Multi-channel payment processing capabilities
- Step-by-step KYC workflow with document upload and verification status tracking
- Real-time language switching supporting English, French, Spanish, and Arabic
- Responsive user interface design optimized for desktop and mobile viewports

### 2.3 Technology Stack

| **Component**        | **Technology**          | **Version/Notes**               |
| -------------------- | ----------------------- | ------------------------------- |
| Frontend Framework   | React Native (Expo)     | TypeScript, Expo Router         |
| Build Tool           | Metro                   | React Native bundler            |
| Package Manager      | pnpm                    | Efficient dependency management |
| UI Components        | NativeWind, TailwindCSS | Utility-first styling           |
| Internationalization | Custom i18n             | Multi-language support          |
| State Management     | Zustand, React Context  | Predictable state updates       |
| API Client           | Axios                   | RESTful API integration         |
| Form Validation      | Zod, React Hook Form    | Schema-based validation         |
| Animation            | Framer Motion           | UI animations                   |
| Testing              | Jest                    | Unit and integration tests      |
| CI/CD                | EAS, GitHub Actions     | Automated build & deployment    |
| Cloud Storage        | AWS S3                  | Static asset hosting            |
| Content Delivery     | AWS CloudFront          | Global CDN distribution         |

### 2.4 Current Status

The application is fully operational across production and development environments. Automated deployment pipelines are active and functional. The system is currently under active maintenance with regular updates and monitoring.

---

## 3. Target Audience

| **Audience**                          | **Relevant Sections**      |
| ------------------------------------- | -------------------------- |
| Stakeholders and Executive Leadership | Sections 1, 2, and 9       |
| Project Managers and Coordinators     | Sections 1, 2, 3, and 9    |
| Software Developers and Engineers     | Sections 4, 5, 6, 7, and 8 |
| QA and Support Personnel              | Sections 3 and 8           |

---

## 4. End User Guide (For Support Teams)

### 4.1 Access Points

- **Staging Environment:** Provided via EAS/Expo Go or TestFlight
- **Development Environment:** Local Expo/Metro server (see Developer Guide)
- **Production Environment:** Distributed via App Store/Play Store (contact technical lead for credentials)

### 4.2 Main User Flows

1. User registration and secure authentication
2. Dashboard access displaying wallet balance and recent transaction history
3. Fund wallet operations and inter-wallet money transfers
4. Payment execution to merchants, bills, or peer users
5. KYC verification workflow including document upload and verification status tracking
6. Language preference selection via settings

### 4.3 Support Guidelines

Support personnel should prioritize utilization of in-application help resources before escalating issues. Common support scenarios include:

- Network connectivity errors and API timeout issues
- KYC document rejection and resubmission procedures
- Password recovery and account access restoration
- Transaction dispute resolution workflows

---

## 5. Developer Guide

### 5.1 Prerequisites

| **Requirement**      | **Minimum Version**   |
| -------------------- | --------------------- |
| Node.js              | 18.x or higher        |
| pnpm                 | Latest stable version |
| Git                  | 2.x or higher         |
| Expo CLI             | Latest                |
| Xcode/Android Studio | For native builds     |

### 5.2 Local Setup Instructions

**Step 1: Clone Repository**

```bash
git clone <repo-url>
cd k-pay-app
```

**Step 2: Install Dependencies**

```bash
pnpm install
```

**Step 3: Run Development Server**

```bash
pnpm start
```

The application will be accessible via Expo Go or a simulator.

**Manual Fallback Procedure (if automated setup fails):**

```bash
cd k-pay-assets && pnpm install && pnpm run build && cd ..
pnpm start
```

### 5.3 Environment Variables

Create a `.env` file in the project root directory with the following configuration variables:

```env
API_URL=https://api.example.com
PUBLIC_APP_NAME=KPay
FLUTTERWAVE_TEST_KEY=your_flutterwave_test_key
```

**Note:** Obtain actual API keys and URLs from the technical lead or secure credential management system.

### 5.4 Project Structure

| **Directory**          | **Description**                                    |
| ---------------------- | -------------------------------------------------- |
| app/                   | All application screens, layouts, and navigation   |
| app/(tabs)/            | Tab navigation and main tab screens                |
| app/airtime/           | Airtime purchase feature (components, data, types) |
| app/auth/              | Authentication screens (login, reset, verify)      |
| app/bills-and-payment/ | Bill payment feature (components, data, types)     |
| app/card/              | Card management (create, view, learn more)         |
| app/convert-currency/  | Currency conversion feature                        |
| app/deposit/           | Deposit flows (via bank, mobile money, etc)        |
| app/onboarding/        | User onboarding and registration                   |
| app/send-money/        | Send money feature                                 |
| app/ticket/            | Support ticketing                                  |
| app/transactions/      | Transaction history                                |
| app/two-factor-auth/   | Two-factor authentication                          |
| app/verification/      | Verification flows                                 |
| assets/                | Images, icons, and static assets                   |
| coverage/              | Test coverage reports                              |
| ios/                   | iOS native project files (Xcode, Pods, etc)        |
| k-pay-assets/          | Shared design system and assets (local package)    |
| schema/                | Zod schemas for validation (auth, banks, etc)      |
| src/                   | Main source code (see Section 15 for details)      |

---

## 6. Architecture Highlights

- **Modular Component Architecture:** Enables independent feature development and parallel team workflows
- **State Management:** Zustand and React Context API for predictable state updates
- **Authentication Security:** JWT token-based authentication with secure token storage and refresh mechanisms
- **Internationalization:** All user-facing text externalized to translation files for simplified localization
- **Error Handling:** Centralized error boundary implementation with comprehensive logging and user feedback
- **Performance Optimization:** Code splitting, lazy loading, and bundle size optimization for fast page loads

---

## 7. Deployment

### 7.1 Environments

| **Environment** | **Trigger**          | **Purpose**                  |
| --------------- | -------------------- | ---------------------------- |
| Production      | EAS build, App Store | Live user-facing application |
| Development     | EAS preview, Expo Go | Testing and QA environment   |

### 7.2 CI/CD Pipeline

EAS and GitHub Actions workflows automatically execute the following deployment sequence:

1. Build application artifacts using EAS
2. Run tests and static analysis
3. Deploy to App Store/Play Store or distribute preview builds

Pipeline configuration files are located in `.github/workflows/` and `eas.json`.

### 7.3 Manual Deployment

For manual deployment execution, utilize the provided EAS scripts:

**Production Deployment:**

```bash
eas build --profile production --platform all
```

**Development Deployment:**

```bash
eas build --profile development --platform all
```

### 7.4 Infrastructure

The application utilizes the following AWS infrastructure components:

- Private S3 bucket for static asset storage with encryption enabled
- CloudFront CDN distribution with Origin Access Control for global content delivery
- AWS Certificate Manager for SSL/TLS certificate management

Comprehensive infrastructure documentation is available in `infrastructure/README.md`, including required GitHub Secrets configuration for automated deployments.

---

## 8. Troubleshooting and Maintenance

### 8.1 Common Fixes

| **Issue**                 | **Resolution**                                              |
| ------------------------- | ----------------------------------------------------------- |
| Asset build failures      | `cd k-pay-assets && pnpm install --force && pnpm run build` |
| Dependency conflicts      | Delete `node_modules` and run `pnpm install`                |
| Metro/Expo port conflicts | Modify port in `app.json` or terminate conflicting process  |
| iOS/Android build errors  | Run `pod install` in `ios/` or check EAS logs               |

### 8.2 Best Practices

- Synchronize local asset packages regularly to maintain asset consistency
- Utilize feature branches for all development work and submit pull requests for code review
- Test application functionality across all supported languages before deployment
- Execute comprehensive testing in development environment before promoting to production
- Monitor application logs and error reporting systems for proactive issue detection
- Maintain up-to-date documentation for all code changes and architectural decisions

---

## 9. Risk Assessment and Recommendations

### Risk Matrix

| **Risk**                            | **Impact** | **Mitigation Strategy**                                                |
| ----------------------------------- | ---------- | ---------------------------------------------------------------------- |
| Asset package access loss           | High       | Ensure team members have appropriate repository permissions            |
| Third-party API changes/deprecation | Medium     | Monitor integration partner communications and maintain versioned APIs |
| KYC regulatory requirement updates  | Medium     | Modular architecture enables rapid compliance updates                  |
| Infrastructure cost escalation      | Low        | Implement monitoring and establish cost alerts for AWS resources       |

### Strategic Recommendations

- Implement end-to-end testing framework (e.g., Detox, Cypress) for automated regression testing
- Integrate error monitoring and application performance management (e.g., Sentry, DataDog)
- Establish comprehensive logging strategy for improved observability
- Implement feature flagging for controlled rollout of new functionality
- Conduct regular security audits and dependency vulnerability scanning

---

## 10. Tools and Resources

### Development Tools

| **Tool**     | **Purpose**           | **Link**                        |
| ------------ | --------------------- | ------------------------------- |
| React Native | Mobile Framework      | https://reactnative.dev/        |
| Expo         | React Native Platform | https://expo.dev/               |
| TypeScript   | Type Safety           | https://www.typescriptlang.org/ |
| pnpm         | Package Manager       | https://pnpm.io/                |
| Git          | Version Control       | https://git-scm.com/            |

### Cloud Infrastructure

| **Service**    | **Purpose**              | **Link**                            |
| -------------- | ------------------------ | ----------------------------------- |
| AWS S3         | Object Storage           | https://aws.amazon.com/s3/          |
| AWS CloudFront | Content Delivery Network | https://aws.amazon.com/cloudfront/  |
| GitHub Actions | CI/CD Automation         | https://github.com/features/actions |

### Repository

- **Primary Repository:** Contact technical lead for access
- **Assets Package:** Local package in `k-pay-assets/`

---

## 11. Additional Documentation

- `README.md` - Project overview and quick start guide
- `infrastructure/README.md` - Detailed infrastructure setup and deployment procedures
- `CONTRIBUTING.md` - Development guidelines and contribution standards
- `CHANGELOG.md` - Version history and release notes
- API documentation - Contact technical lead for access to API specification

---

## 12. Contacts and Support

For any clarifications or transition support, please contact the technical lead or project manager.

---

## 13. Technical Deep Dive: Key Feature Implementation

### 13.1 PIN Creation & Verification

PINs are used to secure sensitive actions such as transfers, withdrawals, and other critical operations. PIN creation and verification are handled via Zod schemas and validated in forms throughout the application.

**How it works:**

- PINs must be exactly 4 digits
- Validation is enforced using Zod schemas (see `transactionPinSchema` in `schema/dashboard.ts`)
- PINs are typically entered in modal forms before confirming a transaction

**Code snippet:**

```tsx
// schema/dashboard.ts
export const transactionPinSchema = () =>
  z.object({
    pin: z
      .string()
      .min(1, { message: 'PIN required' })
      .refine((value) => /^\d{4}$/.test(value), {
        message: 'PIN must be 4 digits',
      }),
  });
```

### 13.2 Transfers & Debit Actions

Transfers (including debit actions) are handled by the `TransferMoney` component, which supports single, multiple, and bulk transfers. The process is step-based and form-driven.

**How it works:**

- User selects transfer method (wallet, bank, etc.)
- Fills out the transfer form (amount, destination, currency)
- Proceeds through steps; on submit, the transfer is processed via API call

**Code snippet:**

```tsx
// app/send-money/transfer-money.tsx
const [formData, setFormData] = useState({
  amount: '',
  destination: '',
  currency: 'UGX',
});

const handleFormSubmit = () => {
  setCurrentStep(2); // Proceed to confirmation step
  // Actual transfer logic would call an API here
};
```

### 13.3 Currency Conversion (Exchange)

Currency exchange is handled in the currency conversion page. Users select currencies and amounts, and the app calculates rates and conversions.

**How it works:**

- User selects source and target currencies
- Enters amount to convert
- The app fetches or calculates the exchange rate and shows the converted amount
- On submit, the exchange is processed via API call

**Code snippet:**

```tsx
// app/convert-currency/index.tsx
const exchangeRate = 1.175;
const recipientAmount = (
  (parseFloat(amount || '0') - fees) *
  exchangeRate
).toFixed(2);
```

### 13.4 Withdrawals

Withdrawals are handled via dedicated forms and require PIN verification. The process is similar to transfers, with additional beneficiary selection.

**How it works:**

- User selects withdrawal method and beneficiary
- Enters amount and PIN (validated by Zod schema)
- On submit, withdrawal is processed via API call

**Code snippet:**

```tsx
// app/transactions/withdrawal.tsx
import { withdrawalRequestPinSchema } from '../../schema/dashboard';

<EasyForm schema={withdrawalRequestPinSchema} onSubmit={handleWithdraw} />;
```

### 13.5 Image Upload

Image and document uploads (e.g., for KYC) use a custom React hook, `useFileUploadEnhanced`.

**How it works:**

- User selects a file (image, PDF, etc.)
- The hook validates file type/size, shows upload progress, and returns a URL on success
- The file is uploaded via an API call

**Code snippet:**

```tsx
// src/hooks/use-file-upload-enhanced.ts
const { uploadFile, isUploading, progress, error } = useFileUploadEnhanced({
  maxSize: 5 * 1024 * 1024, // 5MB
  allowedTypes: ['image/jpeg', 'image/png', 'application/pdf'],
});

const handleUpload = async (file: File) => {
  const result = await uploadFile(file);
  if (result.success) {
    // Use result.url for preview or send to backend
  }
};
```

### 13.6 Authentication & Authorization

Authentication is managed via the `useAuth` hook (`src/hooks/use-auth.ts`). It handles login, token storage, user state, and logout. Tokens are stored securely, and user info is kept in a global store.

**How it works:**

- On login, access and refresh tokens are saved securely
- User roles are also stored
- The user account is set in a global store (`useUserStore`)
- Token refresh is scheduled automatically
- Logout clears all tokens and user state, then redirects to login

**Code snippet:**

```tsx
// src/hooks/use-auth.ts
const setAuthTokens = (accessToken: string, refreshToken: string) => {
  // Store tokens securely
};

const logUser = (userAccount: UserAccount) => {
  // Set user role and schedule token refresh
};

const invalidate = () => {
  // Clear all tokens and user state
};
```

### 13.7 Wallet Creation & Management

Wallet state is managed globally using Zustand (`src/store/wallet-store.ts`). The wallet is persisted in local storage and can be set, updated, or cleared.

**How it works:**

- The `Wallet` interface defines wallet properties (id, owner, status, limits, balances, etc.)
- The store provides `setWallet`, `clearWallet`, and `updateWallet` methods
- The wallet state is persisted using Zustand's `persist` middleware

**Code snippet:**

```tsx
// src/store/wallet-store.ts
export const useWalletStore = create<WalletStore>()(
  persist(
    (set, get) => ({
      wallet: null,
      setWallet: (wallet: Wallet) => {
        set({ wallet });
      },
      clearWallet: () => {
        set({ wallet: null });
      },
      updateWallet: (updates: Partial<Wallet>) => {
        const current = get().wallet;
        if (current) set({ wallet: { ...current, ...updates } });
      },
    }),
    {
      name: 'wallet-store',
      partialize: (state) => ({ wallet: state.wallet }),
    }
  )
);

export const useWallet = () => useWalletStore((state) => state.wallet);
```

---

## 14. Complete Package Reference

### 14.1 Production Dependencies

| **Package**                  | **Purpose**                        |
| ---------------------------- | ---------------------------------- |
| @hookform/resolvers          | Form validation resolvers          |
| @lottiefiles/dotlottie-react | Lottie animation support           |
| @material-tailwind/react     | Material Design components         |
| @radix-ui/\*                 | Unstyled, accessible UI primitives |
| @reactour/tour               | Product tours and onboarding       |
| @tanstack/react-query        | Data fetching and caching          |
| @tanstack/react-router       | Type-safe routing                  |
| @tanstack/react-table        | Headless table building            |
| axios                        | HTTP client                        |
| framer-motion                | Animation library                  |
| i18next                      | Internationalization framework     |
| react-hook-form              | Form management                    |
| recharts                     | Chart visualization                |
| zustand                      | State management                   |
| zod                          | Schema validation                  |
| tailwindcss                  | Utility-first CSS framework        |

### 14.2 Development Dependencies

| **Package**          | **Purpose**                   |
| -------------------- | ----------------------------- |
| @vitejs/plugin-react | Vite React plugin             |
| typescript           | Type checking and compilation |
| eslint               | Code linting                  |
| prettier             | Code formatting               |
| cypress              | End-to-end testing            |
| husky                | Git hooks                     |
| autoprefixer         | CSS vendor prefixing          |
| @faker-js/faker      | Mock data generation          |

---

## 15. Source Directory Structure

This section provides a detailed, professional overview of every folder and major file in the `src/` directory, including subfolders and their responsibilities.

### 15.1 Top-Level Files

- **App.tsx** — Main React Native app composition, providers, and layout
- **app.json** — Expo/React Native app configuration
- **global.css** — Global styles (Tailwind, NativeWind)
- **metro.config.js** — Metro bundler configuration
- **tailwind.config.js** — TailwindCSS configuration
- **tsconfig.json** — TypeScript configuration

### 15.2 Directory Breakdown

#### app/

All application screens, layouts, and navigation. Subfolders group features and flows:

- **(tabs)/**: Tab navigation and main tab screens (cards, home, more, transactions)
- **airtime/**: Airtime purchase feature (components, data, types)
- **auth/**: Authentication screens (login, reset, verify)
- **bills-and-payment/**: Bill payment feature (components, data, types)
- **card/**: Card management (create, view, learn more)
- **convert-currency/**: Currency conversion feature
- **deposit/**: Deposit flows (via bank, mobile money, etc)
- **onboarding/**: User onboarding and registration
- **send-money/**: Send money feature
- **ticket/**: Support ticketing
- **transactions/**: Transaction history
- **two-factor-auth/**: Two-factor authentication
- **verification/**: Verification flows

#### assets/

Images, icons, and static assets. Includes:

- **images/**: App images
- **img/**: Additional image assets

#### coverage/

Test coverage reports (generated by Jest or other test runners).

#### ios/

iOS native project files (Xcode, Pods, etc). Required for native builds and EAS submissions.

#### k-pay-assets/

Local package for shared design system, icons, and UI primitives. Built separately and imported as a dependency.

#### schema/

Zod schemas for validation (auth, banks, bill-payment, dashboard, personal-info, ticket, verifications).

#### src/

Main source code. Key subfolders:

- **components/**: Reusable React components (UI, modules, layouts, etc)
- **constants/**: Static constants (country lists, bank providers, etc)
- **contexts/**: React context providers
- **data/**: Static/mock data for development and demos
- **enums/**: TypeScript enums for app-wide constants
- **helpers/**: Utility/helper functions
- **hooks/**: Custom React hooks for business logic (auth, currencies, file upload, etc)
- **icons/**: SVG and icon components
- **layout/**: Layout wrappers
- **lib/**: Core libraries and integrations (API clients, GraphQL, socket, utils)
- **modules/**: Feature modules (beneficiaries, bill-payment, dashboard, exchange, merchants, payment-link, profile, search-bar, settings, sidebar, ticket, transactions, transfer, wallet)
- **providers/**: React context providers
- **screens/**: Application screens (may be legacy or feature-specific)
- **services/**: Service layer for API integrations (bank, flutterwave, paystack)
- **store/**: Global state management (Zustand stores for user, wallet, KYC, etc)
- **theme/**: Theme and style configuration
- **translations/**: i18n translation files
- **types/**: TypeScript type definitions and interfaces
- **utils/**: General utility functions and helpers
- **validations/**: Validation logic and schemas

---

## 16. Root Folder Structure

This section provides a professional overview of the main folders in the project root, describing their responsibilities and typical contents.

### 16.1 Root-Level Directories

- **assets/**: Local package for shared static assets, icons, and UI primitives. Built separately and imported as a dependency.
- **coverage/**: Test coverage reports.
- **ios/**: iOS native project files (Xcode, Pods, etc).
- **k-pay-assets/**: Shared design system and assets (local package).
- **schema/**: Zod schemas for validation.
- **src/**: Main application source code (see Section 15 for detailed breakdown).

### 16.2 Key Subfolders

- **infrastructure/**: Infrastructure-as-code, deployment scripts, and AWS SAM templates for backend/serverless resources.
- **public/**: Static files served directly (images, SVGs, favicons, etc).

This structure is designed for scalability, modularity, and clarity. Each folder has a clear responsibility, making it easy for new developers to find, understand, and extend the codebase.

---

## 17. Additional Core Feature Details

### 17.1 PIN Creation & Verification

PINs are used to secure sensitive actions (transfers, withdrawals, etc). PIN creation and verification are handled via Zod schemas and validated in forms.

**How it works:**

- PINs are required to be exactly 4 digits
- Validation is enforced using Zod schemas (see `transactionPinSchema` in `schema/dashboard.ts`)
- PINs are typically entered in modal forms before confirming a transaction

**Code snippet:**

```tsx
// schema/dashboard.ts
export const transactionPinSchema = () =>
  z.object({
    pin: z
      .string()
      .min(1, { message: 'PIN required' })
      .refine((value) => /^\d{4}$/.test(value), {
        message: 'PIN must be 4 digits',
      }),
  });
```

### 17.2 Transfers & Debit Actions

Transfers (including debit actions) are handled by the `TransferMoney` component, which supports single, multiple, and bulk transfers. The process is step-based and form-driven.

**How it works:**

- User selects transfer method (wallet, bank, etc)
- Fills out the transfer form (amount, destination, currency)
- Proceeds through steps; on submit, the transfer is processed via API call

**Code snippet:**

```tsx
// app/send-money/transfer-money.tsx
const [formData, setFormData] = useState({
  amount: '',
  destination: '',
  currency: 'UGX',
});

const handleFormSubmit = () => {
  setCurrentStep(2); // Proceed to confirmation step
  // Actual transfer logic would call an API here
};
```

### 17.3 Currency Conversion (Exchange)

Currency exchange is handled in the currency conversion page. Users select currencies and amounts, and the app calculates rates and conversions.

**How it works:**

- User selects source and target currencies
- Enters amount to convert
- The app fetches or calculates the exchange rate and shows the converted amount
- On submit, the exchange is processed via API call

**Code snippet:**

```tsx
// app/convert-currency/index.tsx
const exchangeRate = 1.175;
const recipientAmount = (
  (parseFloat(amount || '0') - fees) *
  exchangeRate
).toFixed(2);
```
